<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Step 4: Set Up Amazon API Gateway - Amazon Pinpoint</title>
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link rel="home" href="#top" />
      <link rel="up" href="tutorials-two-way-sms.html" title="Tutorial: Setting Up an SMS Registration&#xA;            System" />
      <link rel="prev" href="tutorials-two-way-sms-part-3.html" title="Step 3: Create Lambda Functions" />
      <link rel="next" href="tutorials-two-way-sms-part-5.html" title="Step 5: Create and Deploy the Web&#xA;            Form" />
      <meta name="description" content="In this section, you create a new API by using Amazon API Gateway. The registration form that you deploy in this solution calls this API. API Gateway then passes the information that's captured on the registration form to the Lambda function you created in" />
      <meta name="keywords" content="Pinpoint,Amazon Pinpoint,Customer engagement,Segmentation,Campaigns,Metrics" />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="Amazon Pinpoint" />
      <meta name="guide" content="Developer Guide" />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <link rel="icon" type="image/ico" href="images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="images/favicon.ico" />
      <link rel="canonical" href="https://docs.aws.amazon.com/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.min.css" />
      <link rel="stylesheet" type="text/css" href="font/css/font-awesome.min.css" />
      <link rel="stylesheet" type="text/css" href="css/google-font.css" />
      <link id="code-style" rel="stylesheet" type="text/css" href="css/code/light.css" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.theme.css" />
      <link rel="stylesheet" type="text/css" href="css/colorbox.css" />
      <link rel="stylesheet" type="text/css" href="css/awsdocs.css?v=20181221" /><script type="text/javascript" src="js/highlight.pack.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/jquery-ui.min.js"></script><script type="text/javascript" src="js/jquery.colorbox.js"></script><script type="text/javascript" src="js/awsdocs.min.js?v=20181221"></script></head>
   <body id="top">
      <div xmlns:db="http://docbook.org/ns/docbook" id="aws-nav" class="aws-nav-header">
         <div class="aws-nav-header-left">
            <div class="aws-nav-logo">
               <!--aws_logo_105x39.png--><a href="http://aws.amazon.com"><img src="images/aws_logo_105x39.png" alt="Amazon Web Services" /></a></div>
         </div>
         <div id="aws-nav-header-right" class="aws-nav-header-right">
            <div class="aws-nav-cta-button-outer"><a id="aws-nav-cta-button" class="aws-nav-button" href="https://console.aws.amazon.com/console/home">Sign In to the Console</a></div>
            <div class="aws-nav-popover-trigger" data-dropdown="aws-nav-dropdown-lang"><select id="languageSelection" onchange="SelectLanguage()">
                  <option value="/de_de/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">Deutsch</option>
                  <option value="/en_us/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html" selected="selected">English</option>
                  <option value="/es_es/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">Español</option>
                  <option value="/fr_fr/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">Français</option>
                  <option value="/it_it/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">Italiano</option>
                  <option value="/ja_jp/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">日本語</option>
                  <option value="/ko_kr/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">한국어</option>
                  <option value="/pt_br/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">Português</option>
                  <option value="/zh_cn/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">中文 (简体)</option>
                  <option value="/zh_tw/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">中文 (繁體)</option></select></div><a class="btn btn-kindle-link" id="kindle-link-top" target="_blank" href="http://www.amazon.com/dp/B07JKHTQVP" title="Open Kindle"></a><a class="btn btn-pdf-link" id="pdf-link-top" href="pinpoint-dg.pdf#tutorials-two-way-sms-part-4" target="_blank" title="Open PDF"></a><a class="btn btn-github-link" id="github-link-top" href="https://github.com/awsdocs/amazon-pinpoint-developer-guide/tree/master/doc-source/tutorials-two-way-sms-part-4.md" target="_blank" title="Edit on GitHub"></a><div id="aws-nav-quicklinks-separator" class="aws-nav-quicklinks-separator">
               <div class="aws-nav-left"></div>
               <div class="aws-nav-right"></div>
            </div>
         </div>
      </div>
      <div id="content-container">
         <div id="left-column">
            <div id="left-col-header">
               <div xmlns:db="http://docbook.org/ns/docbook" id="left-col-top-content">
                  <div id="service-name">Amazon Pinpoint </div>
                  <div id="search"><i id="search-icon" class="fa fa-search fa-2x"></i></div>
                  <div id="guide-info">Developer Guide
                     <div id="content-button"><i id="toggle-contents" class="fa fa-bars"></i></div>
                  </div>
               </div>
               <form id="finegrainedSearch" method="get" onsubmit="return searchFormSubmit(this);" action="/search/doc-search.html">
                  <div id="search-form"><select id="search-select" name="searchPath">
                        <option value="all">Entire Site</option>
                        <option value="AWSMarketplace">AMIs from AWS Marketplace</option>
                        <option value="amis">AMIs from All Sources</option>
                        <option value="articles">Articles &amp; Tutorials</option>
                        <option value="products_and_info">AWS Product Information</option>
                        <option value="case_studies">Case Studies</option>
                        <option value="customerapps">Customer Apps</option>
                        <option value="documentation">Documentation</option>
                        <option value="documentation-product">Documentation - This Product</option>
                        <option value="documentation-guide" selected="selected">Documentation - This Guide</option>
                        <option value="datasets">Public Data Sets</option>
                        <option value="releasenotes">Release Notes</option>
                        <option value="solution_providers">Partners</option>
                        <option value="code">Sample Code &amp; Libraries</option></select><br /><input id="search-query" name="searchQuery" type="text" placeholder="Search" /><input id="search-button" src="images/search-button.png" alt="Go" type="image" /></div><input type="hidden" name="this_doc_product" id="this_doc_product" value="Amazon Pinpoint" /><input type="hidden" name="this_doc_guide" id="this_doc_guide" value="Developer Guide" /><input type="hidden" name="doc_locale" value="en_us" /></form>
            </div>
            <div id="toc"></div>
         </div>
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tr>
                           <td>
                              <div class="breadcrumb"><a href="/index.html">AWS Documentation</a> » <a href="/pinpoint/index.html">Amazon Pinpoint</a> » <a href="index.html">Developer Guide</a> » <a href="tutorials.html">Tutorials</a> » <a href="tutorials-two-way-sms.html">Tutorial: Setting Up an SMS Registration
                                    System</a> » <span class="breadcrumb">Step 4: Set Up Amazon API Gateway</span></div>
                           </td>
                        </tr>
                     </table>
                     <div id="language-notice">
                        <div class="language-notice-text"></div>
                     </div>
                     <div></div>
                     <h1 class="topictitle" id="tutorials-two-way-sms-part-4">Step 4: Set Up Amazon API Gateway</h1>
                     <p>In this section, you create a new API by using Amazon API Gateway. The registration
                        form that you
                        deploy in this solution calls this API. API Gateway then passes the information that's
                        captured on
                        the registration form to the Lambda function you created in <a href="tutorials-two-way-sms-part-3.html">Step 3</a>.
                     </p>
                     
                     <h2 id="tutorials-two-way-sms-part-4-create-api">Step 4.1: Create the
                        API
                     </h2>
                     
                     <p>First, you have to create a new API in API Gateway. The following procedures show
                        you how to
                        create a new REST API.
                     </p>
                     
                     <p class="title"><b>To create a new API</b></p>
                     <ol>
                        <li>
                           <p>Open the API Gateway console at
                              <a href="https://console.aws.amazon.com/apigateway/" target="_blank">https://console.aws.amazon.com/apigateway/</a>.
                              
                           </p>
                        </li>
                        <li>
                           
                           <p>Choose <b>Create API</b>. Make the following selections:
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>Under <b>Choose the protocol</b>, choose
                                       <b>REST</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>Under <b>Create new API</b>, choose <b>New
                                          API</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>Under <b>Settings</b>, for <b>Name</b>,
                                       enter a name, such as <strong class="userinput"><code>RegistrationForm</code></strong>. For
                                       <b>Description</b>, optionally enter some text that
                                       describes the purpose of the API. For <b>Endpoint
                                          Type</b>, choose <b>Regional</b>. Then, choose
                                       <b>Create API</b>.
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                           <p>An example of these settings is shown in the following image.</p>
                           
                           <div class="mediaobject">
                              
                              <img src="images/SMS_Reg_Tutorial_APIGW_Step2.png" />
                              
                              
                           </div>
                           
                        </li>
                     </ol>
                     
                     
                     <h2 id="tutorials-two-way-sms-part-4-create-resource">Step 4.2: Create a
                        Resource
                     </h2>
                     
                     <p>Now that you've created an API, you can start to add resources to it. After that,
                        you
                        add a POST method to the resource, and tell API Gateway to pass the data that you
                        receive from
                        this method to your Lambda function.
                     </p>
                     
                     <ol>
                        <li>
                           
                           <p>On the <b>Actions</b> menu, choose <b>Create
                                 Resource</b>. In the <b>New Child Resource</b> pane,
                              for <b>Resource Name</b>, enter <strong class="userinput"><code>register</code></strong>,
                              as shown in the following image. Choose <b>Create
                                 Resource</b>.
                           </p>
                           
                           <div class="mediaobject">
                              
                              <img src="images/SMS_Reg_Tutorial_APIGW_Step3.png" />
                              
                              
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>On the <b>Actions</b> menu, choose <b>Create
                                 Method</b>. From the menu that appears, choose
                              <b>POST</b>, as shown in the following image. Then choose the
                              <b>check mark</b> (<span class="inlinemediaobject">
                                 
                                 <img src="images/APIGW_Check_Button.png" />
                                 
                                 </span>) button.
                           </p>
                           
                           <div class="mediaobject">
                              
                              <img src="images/SMS_Reg_Tutorial_APIGW_Step4.png" />
                              
                              
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>In the <b>/register - POST - Setup</b> pane, make the following
                              selections:
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>For <b>Integration type</b>, choose <b>Lambda
                                          Function</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>Choose <b>Use Lambda Proxy Integration</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>For <b>Lambda Region</b>, choose the Region that you
                                       created the Lambda function in.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>For <b>Lambda Function</b>, choose the RegisterEndpoint
                                       function that you created in <a href="tutorials-two-way-sms-part-3.html">Step 3</a>.
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                           <p>An example of these settings is shown in the following image.</p>
                           
                           <div class="mediaobject">
                              
                              <img src="images/SMS_Reg_Tutorial_APIGW_Step5.png" />
                              
                              
                           </div>
                           
                           <p>Choose <b>Save</b>. On the window that appears, choose
                              <b>OK</b> to give API Gateway permission to execute your Lambda
                              function.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <h2 id="tutorials-two-way-sms-part-4-deploy-api">Step 4.3: Deploy the
                        API
                     </h2>
                     
                     <p>The API is now ready to use. At this point, you have to deploy it in order to create
                        a
                        publicly accessible endpoint.
                     </p>
                     
                     <ol>
                        <li>
                           
                           <p>On the <b>Actions</b> menu, choose <b>Deploy
                                 API</b>. On the <b>Deploy API</b> window, make the
                              following selections:
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>For <b>Deployment stage</b>, choose <b>[New
                                          Stage]</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>For <b>Stage name</b>, enter
                                       <strong class="userinput"><code>v1</code></strong>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>Choose <b>Deploy</b>.
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                           <p>An example of these selections is shown in the following image.</p>
                           
                           <div class="mediaobject">
                              
                              <img src="images/SMS_Reg_Tutorial_APIGW_Step6.png" />
                              
                              
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>In the <b>v1 Stage Editor</b> pane, choose the
                              <b>/register</b> resource, and then choose the
                              <b>POST</b> method. Copy the address that's shown next to
                              <b>Invoke URL</b>, as shown in the following image.
                           </p>
                           
                           <div class="mediaobject">
                              
                              <img src="images/SMS_Reg_Tutorial_APIGW_Step7.png" />
                              
                              
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>In the navigation pane, choose <b>Resources</b>. In the list of
                              resources, choose the <b>/register</b> resource. Finally, on the
                              <b>Actions</b> menu, choose <b>Enable CORS</b>,
                              as shown in the following image.
                           </p>
                           
                           <div class="mediaobject">
                              
                              <img src="images/SMS_Reg_Tutorial_APIGW_Step8.png" />
                              
                              
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>On the <b>Enable CORS</b> pane, choose <b>Enable CORS and
                                 replace existing CORS headers</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     <p><b>Next</b>: <a href="tutorials-two-way-sms-part-5.html">Create
                           and Deploy the Web Form</a></p>
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="tutorials-two-way-sms-part-3.html">« Previous </a><a class="awstoc" accesskey="n" href="tutorials-two-way-sms-part-5.html">Next »</a></div>
                     <div id="copyright-main-footer">© 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Step 4.1: Create the&#xA;                API"><a class="pagetoc" href="#tutorials-two-way-sms-part-4-create-api">Create the
                              API</a></li>
                        <li class="pagetoc" name="Step 4.2: Create a&#xA;                Resource"><a class="pagetoc" href="#tutorials-two-way-sms-part-4-create-resource">Create a
                              Resource</a></li>
                        <li class="pagetoc" name="Step 4.3: Deploy the&#xA;                API"><a class="pagetoc" href="#tutorials-two-way-sms-part-4-deploy-api">Deploy the
                              API</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div id="cookie-notice">
         <div class="cookie-notice-text">We use cookies to provide and improve our services. By using our site, you consent
            to cookies. <a href="http://aws.amazon.com/legal/cookies">Learn more</a></div>
      </div>
      <div id="footer">
         <div id="footer_short_fb" class="hide" title="Feedback"><a target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Pinpoint&amp;topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html&amp;hidden_guide_name=Developer Guide&amp;hidden_api_version=&amp;hidden_file_name=tutorials-two-way-sms-part-4"><i class="awsdocs-footer-text fa fa-envelope-o"></i></a></div>
         <div id="footer_toggle" class="mediaobject">
            <div id="footer_toggle_img" class="awsdocs-footer-text fa fa-caret-down"></div>
            <div id="footer_toggle_img_collapse" class="hide awsdocs-footer-text fa fa-caret-right"></div>
         </div>
         <div id="footer-left"><a class="awsdocs-footer-text" target="_top" href="http://aws.amazon.com/terms">Terms of Use</a><span class="awsdocs-footer-text"> | </span><a class="awsdocs-footer-text" target="_top" href="http://aws.amazon.com/privacy">Privacy</a><span class="awsdocs-footer-text"> | </span><span class="awsdocs-footer-text">© 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.</span></div>
         <div id="footer-right">
            <div id="feedback">
               <div id="forums"><a id="forum_link" target="_blank" href="http://forums.aws.amazon.com/forum.jspa?forumID=225" class="awsdocs-footer-text">Have a question? Try the Forums.</a></div>
               <div id="feedback-message" class="awsdocs-footer-text">Did this page help you?</div>
               <div id="feedback-yesno-buttons"><a class="awstoc btn btn-default" target="_blank" href="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">Yes</a><a class="awstoc btn btn-default" target="_blank" href="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html">No</a></div>
               <div id="feedback-feedback-button"><a class="awstoc btn btn-default" target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Pinpoint&amp;topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-two-way-sms-part-4.html&amp;hidden_guide_name=Developer Guide&amp;hidden_api_version=&amp;hidden_file_name=tutorials-two-way-sms-part-4">Feedback</a></div>
            </div>
         </div>
      </div>
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Pinpoint';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   </body>
</html>