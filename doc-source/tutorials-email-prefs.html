<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Tutorial: Setting Up an Email Preference Management
         System - Amazon Pinpoint
      </title>
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link rel="home" href="#top" />
      <link rel="up" href="tutorials.html" title="Tutorials" />
      <link rel="prev" href="tutorials-importing-data-next-steps.html" title="Next Steps" />
      <link rel="next" href="tutorials-email-prefs-prereqs.html" title="Prerequisites" />
      <meta name="description" content="In many jurisdictions around the world, email senders are required to include a mechanism for opting out of email communications in each email that they send." />
      <meta name="keywords" content="Pinpoint,Amazon Pinpoint,Customer engagement,Segmentation,Campaigns,Metrics" />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="Amazon Pinpoint" />
      <meta name="guide" content="Developer Guide" />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <link rel="icon" type="image/ico" href="images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="images/favicon.ico" />
      <link rel="canonical" href="https://docs.aws.amazon.com/pinpoint/latest/developerguide/tutorials-email-prefs.html" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.min.css" />
      <link rel="stylesheet" type="text/css" href="font/css/font-awesome.min.css" />
      <link rel="stylesheet" type="text/css" href="css/google-font.css" />
      <link id="code-style" rel="stylesheet" type="text/css" href="css/code/light.css" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.theme.css" />
      <link rel="stylesheet" type="text/css" href="css/colorbox.css" />
      <link rel="stylesheet" type="text/css" href="css/awsdocs.css?v=20181221" /><script type="text/javascript" src="js/highlight.pack.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/jquery-ui.min.js"></script><script type="text/javascript" src="js/jquery.colorbox.js"></script><script type="text/javascript" src="js/awsdocs.min.js?v=20181221"></script></head>
   <body id="top">
      <div xmlns:db="http://docbook.org/ns/docbook" id="aws-nav" class="aws-nav-header">
         <div class="aws-nav-header-left">
            <div class="aws-nav-logo">
               <!--aws_logo_105x39.png--><a href="http://aws.amazon.com"><img src="images/aws_logo_105x39.png" alt="Amazon Web Services" /></a></div>
         </div>
         <div id="aws-nav-header-right" class="aws-nav-header-right">
            <div class="aws-nav-cta-button-outer"><a id="aws-nav-cta-button" class="aws-nav-button" href="https://console.aws.amazon.com/console/home">Sign In to the Console</a></div>
            <div class="aws-nav-popover-trigger" data-dropdown="aws-nav-dropdown-lang"><select id="languageSelection" onchange="SelectLanguage()">
                  <option value="/de_de/pinpoint/latest/developerguide/tutorials-email-prefs.html">Deutsch</option>
                  <option value="/en_us/pinpoint/latest/developerguide/tutorials-email-prefs.html" selected="selected">English</option>
                  <option value="/es_es/pinpoint/latest/developerguide/tutorials-email-prefs.html">Español</option>
                  <option value="/fr_fr/pinpoint/latest/developerguide/tutorials-email-prefs.html">Français</option>
                  <option value="/it_it/pinpoint/latest/developerguide/tutorials-email-prefs.html">Italiano</option>
                  <option value="/ja_jp/pinpoint/latest/developerguide/tutorials-email-prefs.html">日本語</option>
                  <option value="/ko_kr/pinpoint/latest/developerguide/tutorials-email-prefs.html">한국어</option>
                  <option value="/pt_br/pinpoint/latest/developerguide/tutorials-email-prefs.html">Português</option>
                  <option value="/zh_cn/pinpoint/latest/developerguide/tutorials-email-prefs.html">中文 (简体)</option>
                  <option value="/zh_tw/pinpoint/latest/developerguide/tutorials-email-prefs.html">中文 (繁體)</option></select></div><a class="btn btn-kindle-link" id="kindle-link-top" target="_blank" href="http://www.amazon.com/dp/B07JKHTQVP" title="Open Kindle"></a><a class="btn btn-pdf-link" id="pdf-link-top" href="pinpoint-dg.pdf#tutorials-email-prefs" target="_blank" title="Open PDF"></a><a class="btn btn-github-link" id="github-link-top" href="https://github.com/awsdocs/amazon-pinpoint-developer-guide/tree/master/doc-source/tutorials-email-prefs.md" target="_blank" title="Edit on GitHub"></a><div id="aws-nav-quicklinks-separator" class="aws-nav-quicklinks-separator">
               <div class="aws-nav-left"></div>
               <div class="aws-nav-right"></div>
            </div>
         </div>
      </div>
      <div id="content-container">
         <div id="left-column">
            <div id="left-col-header">
               <div xmlns:db="http://docbook.org/ns/docbook" id="left-col-top-content">
                  <div id="service-name">Amazon Pinpoint </div>
                  <div id="search"><i id="search-icon" class="fa fa-search fa-2x"></i></div>
                  <div id="guide-info">Developer Guide
                     <div id="content-button"><i id="toggle-contents" class="fa fa-bars"></i></div>
                  </div>
               </div>
               <form id="finegrainedSearch" method="get" onsubmit="return searchFormSubmit(this);" action="/search/doc-search.html">
                  <div id="search-form"><select id="search-select" name="searchPath">
                        <option value="all">Entire Site</option>
                        <option value="AWSMarketplace">AMIs from AWS Marketplace</option>
                        <option value="amis">AMIs from All Sources</option>
                        <option value="articles">Articles &amp; Tutorials</option>
                        <option value="products_and_info">AWS Product Information</option>
                        <option value="case_studies">Case Studies</option>
                        <option value="customerapps">Customer Apps</option>
                        <option value="documentation">Documentation</option>
                        <option value="documentation-product">Documentation - This Product</option>
                        <option value="documentation-guide" selected="selected">Documentation - This Guide</option>
                        <option value="datasets">Public Data Sets</option>
                        <option value="releasenotes">Release Notes</option>
                        <option value="solution_providers">Partners</option>
                        <option value="code">Sample Code &amp; Libraries</option></select><br /><input id="search-query" name="searchQuery" type="text" placeholder="Search" /><input id="search-button" src="images/search-button.png" alt="Go" type="image" /></div><input type="hidden" name="this_doc_product" id="this_doc_product" value="Amazon Pinpoint" /><input type="hidden" name="this_doc_guide" id="this_doc_guide" value="Developer Guide" /><input type="hidden" name="doc_locale" value="en_us" /></form>
            </div>
            <div id="toc"></div>
         </div>
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tr>
                           <td>
                              <div class="breadcrumb"><a href="/index.html">AWS Documentation</a> » <a href="/pinpoint/index.html">Amazon Pinpoint</a> » <a href="index.html">Developer Guide</a> » <a href="tutorials.html">Tutorials</a> » <span class="breadcrumb">Tutorial: Setting Up an Email Preference Management
                                    System</span></div>
                           </td>
                        </tr>
                     </table>
                     <div id="language-notice">
                        <div class="language-notice-text"></div>
                     </div>
                     <div></div>
                     <h1 class="topictitle" id="tutorials-email-prefs">Tutorial: Setting Up an Email Preference Management
                        System
                     </h1>
                     <p>In many jurisdictions around the world, email senders are required to include a mechanism
                        for opting out of email communications in each email that they send.
                     </p>
                     <p>A common way to allow customers to specify their preferences is to host a page that
                        customers can use to choose the specific types of messages that they want to receive.
                        Typically, customers can also use this same page to completely opt out of all email
                        communications that you send.
                     </p>
                     <p>This tutorial shows you how to set up a web form that you can use to capture your
                        customers' email preferences. The web form sends this information to Amazon Pinpoint.
                        Amazon Pinpoint then
                        creates or modifies attributes in the customer's endpoint record that indicate the
                        topics
                        they want to receive information about. You can use these attributes when you create
                        segments in Amazon Pinpoint.
                     </p>
                     <p>The web form also includes an option that customers can choose to opt themselves out
                        of
                        all email communications. When customers choose this option, they're automatically
                        opted out
                        of all topics. Additionally, the solution in this tutorial modifies their endpoint
                        records
                        so that they don't appear in any future segments in your Amazon Pinpoint project.
                     </p>
                     
                     <h2 id="tutorials-email-prefs-arch">Architecture</h2>
                     
                     <p>When you use the solution that's described in this tutorial, you send a campaign email
                        to your customers. This email contains a link to a preference management page. The
                        link
                        contains several attribute tags that identify each recipient.
                     </p>
                     
                     <p>When customers receive the email from you, they can choose the link. When they do,
                        they're taken to a web form that they can use to opt into or out of various topics.
                        The
                        form sends this data to an API that's hosted by API Gateway. This API triggers a Lambda
                        function, which makes changes to the customer's endpoint record.
                     </p>
                     
                     <p>The following diagram shows the flow of information in this solution.</p>
                     
                     <div class="mediaobject">
                        
                        <img src="images/Email_Prefs_Tutorial_Architecture.png" />
                        
                        
                     </div>
                     
                     
                     <h2 id="tutorials-email-prefs-about">About This Solution</h2>
                     
                     <p>This section contains information about the solution that you're building in this
                        tutorial.
                     </p>
                     
                     
                     <p class="title"><b>Intended Audience</b></p>
                     
                     <p>This tutorial is intended for developers and system implementers. You don't have
                        to be familiar with Amazon Pinpoint to complete the steps in this tutorial. You should
                        be
                        comfortable managing IAM policies, creating Lambda functions in Node.js, and
                        deploying web content. However, you don't need to write any code—this tutorial
                        includes complete example code that you can implement without having to make any
                        changes.
                     </p>
                     
                     
                     
                     <p class="title"><b>Features Used</b></p>
                     
                     <p>This tutorial includes usage examples for the following Amazon Pinpoint features:</p>
                     
                     
                     <div class="itemizedlist">
                        
                        
                        
                        
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>Creating dynamic segments</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Sending email campaigns that contain personalized content</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Interacting with the Amazon Pinpoint API by using AWS Lambda</p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <p class="title"><b>Time Required</b></p>
                     
                     <p>It should take about 30–45 minutes to complete this tutorial. After you
                        implement this solution, there are additional steps that you can take to refine the
                        solution to suit your unique use case.
                     </p>
                     
                     
                     
                     <p class="title"><b>Regional Restrictions</b></p>
                     
                     <p>There are no regional restrictions associated with using this solution. However,
                        you should make sure that the email campaigns that you send include all of the
                        information that's required in each recipient's jurisdiction. 
                     </p>
                     
                     
                     
                     <p class="title"><b>Resource Usage Costs</b></p>
                     
                     <p>There's no charge for creating an AWS account. However, by implementing this
                        solution, you might incur some or all of the costs that are listed in the following
                        table.
                     </p>
                     
                     
                     <div class="table">
                        <div class="table-contents">
                           <table id="w230aab7c12c13c17">
                              
                              <tr>
                                 
                                 <th>Description</th>
                                 
                                 <th>Cost (US Dollars)</th>
                                 
                              </tr>
                              
                              
                              <tr>
                                 
                                 <td>
                                    <p>Message sending costs</p>
                                 </td>
                                 
                                 <td>
                                    <p>You pay $0.0001 for each email that you send through
                                       Amazon Pinpoint.
                                    </p>
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    <p>Monthly targeted audience</p>
                                 </td>
                                 
                                 <td>
                                    <p>You pay $0 for the first 5,000 endpoints that you target in
                                       Amazon Pinpoint each month. After that, you pay $0.0012 per endpoint that you
                                       target.
                                    </p>
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    <p>Lambda usage</p>
                                 </td>
                                 
                                 <td>
                                    <p>The Lambda function in this tutorial uses about 80–90 MB
                                       of memory and about 100–300 milliseconds of compute time each
                                       time it's executed.
                                    </p>
                                    
                                    <p>Your usage of AWS Lambda in implementing this solution might be
                                       included in the Free Tier. For more information, see <a href="https://aws.amazon.com/lambda/pricing/" target="_blank">AWS Lambda
                                          Pricing</a>.
                                    </p>
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    <p>API Gateway usage</p>
                                 </td>
                                 
                                 <td>
                                    <p>You pay $0.0000035–$0.0000037 per API request, depending
                                       on which AWS Region you use. For more information, see <a href="https://aws.amazon.com/api-gateway/pricing/" target="_blank">Amazon API Gateway
                                          Pricing</a>.
                                    </p>
                                 </td>
                                 
                              </tr>
                              
                              <tr>
                                 
                                 <td>
                                    <p>Web hosting costs</p>
                                 </td>
                                 
                                 <td>
                                    <p>The price that you pay varies depending on your web hosting
                                       provider.
                                    </p>
                                 </td>
                                 
                              </tr>
                              
                           </table>
                        </div>
                     </div>
                     
                     <p><b>Next</b>: <a href="tutorials-email-prefs-prereqs.html">Prerequisites</a></p>
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="tutorials-importing-data-next-steps.html">« Previous </a><a class="awstoc" accesskey="n" href="tutorials-email-prefs-prereqs.html">Next »</a></div>
                     <div id="copyright-main-footer">© 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Architecture"><a class="pagetoc" href="#tutorials-email-prefs-arch">Architecture</a></li>
                        <li class="pagetoc" name="About This Solution"><a class="pagetoc" href="#tutorials-email-prefs-about">About This Solution</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div id="cookie-notice">
         <div class="cookie-notice-text">We use cookies to provide and improve our services. By using our site, you consent
            to cookies. <a href="http://aws.amazon.com/legal/cookies">Learn more</a></div>
      </div>
      <div id="footer">
         <div id="footer_short_fb" class="hide" title="Feedback"><a target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Pinpoint&amp;topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-email-prefs.html&amp;hidden_guide_name=Developer Guide&amp;hidden_api_version=&amp;hidden_file_name=tutorials-email-prefs"><i class="awsdocs-footer-text fa fa-envelope-o"></i></a></div>
         <div id="footer_toggle" class="mediaobject">
            <div id="footer_toggle_img" class="awsdocs-footer-text fa fa-caret-down"></div>
            <div id="footer_toggle_img_collapse" class="hide awsdocs-footer-text fa fa-caret-right"></div>
         </div>
         <div id="footer-left"><a class="awsdocs-footer-text" target="_top" href="http://aws.amazon.com/terms">Terms of Use</a><span class="awsdocs-footer-text"> | </span><a class="awsdocs-footer-text" target="_top" href="http://aws.amazon.com/privacy">Privacy</a><span class="awsdocs-footer-text"> | </span><span class="awsdocs-footer-text">© 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.</span></div>
         <div id="footer-right">
            <div id="feedback">
               <div id="forums"><a id="forum_link" target="_blank" href="http://forums.aws.amazon.com/forum.jspa?forumID=225" class="awsdocs-footer-text">Have a question? Try the Forums.</a></div>
               <div id="feedback-message" class="awsdocs-footer-text">Did this page help you?</div>
               <div id="feedback-yesno-buttons"><a class="awstoc btn btn-default" target="_blank" href="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-email-prefs.html">Yes</a><a class="awstoc btn btn-default" target="_blank" href="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-email-prefs.html">No</a></div>
               <div id="feedback-feedback-button"><a class="awstoc btn btn-default" target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Pinpoint&amp;topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-email-prefs.html&amp;hidden_guide_name=Developer Guide&amp;hidden_api_version=&amp;hidden_file_name=tutorials-email-prefs">Feedback</a></div>
            </div>
         </div>
      </div>
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Pinpoint';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   </body>
</html>