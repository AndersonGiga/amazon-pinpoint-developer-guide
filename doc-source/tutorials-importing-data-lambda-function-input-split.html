<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Step 4: Create the
         Lambda Function That Splits Input Data - Amazon Pinpoint
      </title>
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <link rel="home" href="#top" />
      <link rel="up" href="tutorials-importing-data.html" title="Tutorial: Importing Data Into Amazon Pinpoint From External&#xA;            Sources" />
      <link rel="prev" href="tutorials-importing-data-create-python-package.html" title="Step 3: Create a Package&#xA;            That Contains the Required Python Libraries" />
      <link rel="next" href="tutorials-importing-data-lambda-function-process-incoming.html" title="Step 5: Create&#xA;            the Lambda Function That Processes the Incoming Records" />
      <meta name="description" content="The solution that's described in this tutorial uses three Lambda functions. The first Lambda function is triggered when you upload a file to a specific Amazon S3 bucket. This function reads the content of the input file, and then breaks it into smaller parts. Other functions (which you create later in this tutorial) process these incoming files concurrently. Processing the files concurrently reduces the amount of time that it takes to import all of the endpoints into Amazon Pinpoint." />
      <meta name="keywords" content="Pinpoint,Amazon Pinpoint,Customer engagement,Segmentation,Campaigns,Metrics" />
      <meta name="deployment_region" content="IAD" />
      <meta name="product" content="Amazon Pinpoint" />
      <meta name="guide" content="Developer Guide" />
      <meta name="guide-locale" content="en_us" />
      <meta name="tocs" content="toc-contents.json" />
      <link rel="icon" type="image/ico" href="images/favicon.ico" />
      <link rel="shortcut icon" type="image/ico" href="images/favicon.ico" />
      <link rel="canonical" href="https://docs.aws.amazon.com/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.min.css" />
      <link rel="stylesheet" type="text/css" href="font/css/font-awesome.min.css" />
      <link rel="stylesheet" type="text/css" href="css/google-font.css" />
      <link id="code-style" rel="stylesheet" type="text/css" href="css/code/light.css" />
      <link rel="stylesheet" type="text/css" href="css/jquery-ui.theme.css" />
      <link rel="stylesheet" type="text/css" href="css/colorbox.css" />
      <link rel="stylesheet" type="text/css" href="css/awsdocs.css?v=20181221" /><script type="text/javascript" src="js/highlight.pack.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/jquery-ui.min.js"></script><script type="text/javascript" src="js/jquery.colorbox.js"></script><script type="text/javascript" src="js/awsdocs.min.js?v=20181221"></script></head>
   <body id="top">
      <div xmlns:db="http://docbook.org/ns/docbook" id="aws-nav" class="aws-nav-header">
         <div class="aws-nav-header-left">
            <div class="aws-nav-logo">
               <!--aws_logo_105x39.png--><a href="http://aws.amazon.com"><img src="images/aws_logo_105x39.png" alt="Amazon Web Services" /></a></div>
         </div>
         <div id="aws-nav-header-right" class="aws-nav-header-right">
            <div class="aws-nav-cta-button-outer"><a id="aws-nav-cta-button" class="aws-nav-button" href="https://console.aws.amazon.com/console/home">Sign In to the Console</a></div>
            <div class="aws-nav-popover-trigger" data-dropdown="aws-nav-dropdown-lang"><select id="languageSelection" onchange="SelectLanguage()">
                  <option value="/de_de/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">Deutsch</option>
                  <option value="/en_us/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html" selected="selected">English</option>
                  <option value="/es_es/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">Español</option>
                  <option value="/fr_fr/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">Français</option>
                  <option value="/it_it/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">Italiano</option>
                  <option value="/ja_jp/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">日本語</option>
                  <option value="/ko_kr/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">한국어</option>
                  <option value="/pt_br/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">Português</option>
                  <option value="/zh_cn/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">中文 (简体)</option>
                  <option value="/zh_tw/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">中文 (繁體)</option></select></div><a class="btn btn-kindle-link" id="kindle-link-top" target="_blank" href="http://www.amazon.com/dp/B07JKHTQVP" title="Open Kindle"></a><a class="btn btn-pdf-link" id="pdf-link-top" href="pinpoint-dg.pdf#tutorials-importing-data-lambda-function-input-split" target="_blank" title="Open PDF"></a><a class="btn btn-github-link" id="github-link-top" href="https://github.com/awsdocs/amazon-pinpoint-developer-guide/tree/master/doc-source/tutorials-importing-data-lambda-function-input-split.md" target="_blank" title="Edit on GitHub"></a><div id="aws-nav-quicklinks-separator" class="aws-nav-quicklinks-separator">
               <div class="aws-nav-left"></div>
               <div class="aws-nav-right"></div>
            </div>
         </div>
      </div>
      <div id="content-container">
         <div id="left-column">
            <div id="left-col-header">
               <div xmlns:db="http://docbook.org/ns/docbook" id="left-col-top-content">
                  <div id="service-name">Amazon Pinpoint </div>
                  <div id="search"><i id="search-icon" class="fa fa-search fa-2x"></i></div>
                  <div id="guide-info">Developer Guide
                     <div id="content-button"><i id="toggle-contents" class="fa fa-bars"></i></div>
                  </div>
               </div>
               <form id="finegrainedSearch" method="get" onsubmit="return searchFormSubmit(this);" action="/search/doc-search.html">
                  <div id="search-form"><select id="search-select" name="searchPath">
                        <option value="all">Entire Site</option>
                        <option value="AWSMarketplace">AMIs from AWS Marketplace</option>
                        <option value="amis">AMIs from All Sources</option>
                        <option value="articles">Articles &amp; Tutorials</option>
                        <option value="products_and_info">AWS Product Information</option>
                        <option value="case_studies">Case Studies</option>
                        <option value="customerapps">Customer Apps</option>
                        <option value="documentation">Documentation</option>
                        <option value="documentation-product">Documentation - This Product</option>
                        <option value="documentation-guide" selected="selected">Documentation - This Guide</option>
                        <option value="datasets">Public Data Sets</option>
                        <option value="releasenotes">Release Notes</option>
                        <option value="solution_providers">Partners</option>
                        <option value="code">Sample Code &amp; Libraries</option></select><br /><input id="search-query" name="searchQuery" type="text" placeholder="Search" /><input id="search-button" src="images/search-button.png" alt="Go" type="image" /></div><input type="hidden" name="this_doc_product" id="this_doc_product" value="Amazon Pinpoint" /><input type="hidden" name="this_doc_guide" id="this_doc_guide" value="Developer Guide" /><input type="hidden" name="doc_locale" value="en_us" /></form>
            </div>
            <div id="toc"></div>
         </div>
         <div id="main-column">
            <div id="main">
               <div id="main-content">
                  <div id="main-col-body">
                     <table summary="Breadcrumbs">
                        <tr>
                           <td>
                              <div class="breadcrumb"><a href="/index.html">AWS Documentation</a> » <a href="/pinpoint/index.html">Amazon Pinpoint</a> » <a href="index.html">Developer Guide</a> » <a href="tutorials.html">Tutorials</a> » <a href="tutorials-importing-data.html">Tutorial: Importing Data Into Amazon Pinpoint From External
                                    Sources</a> » <span class="breadcrumb">Step 4: Create the
                                    Lambda Function That Splits Input Data</span></div>
                           </td>
                        </tr>
                     </table>
                     <div id="language-notice">
                        <div class="language-notice-text"></div>
                     </div>
                     <div></div>
                     <h1 class="topictitle" id="tutorials-importing-data-lambda-function-input-split">Step 4: Create the
                        Lambda Function That Splits Input Data
                     </h1>
                     <p>The solution that's described in this tutorial uses three Lambda functions. The first
                        Lambda
                        function is triggered when you upload a file to a specific Amazon S3 bucket. This
                        function reads
                        the content of the input file, and then breaks it into smaller parts. Other functions
                        (which
                        you create later in this tutorial) process these incoming files concurrently. Processing
                        the
                        files concurrently reduces the amount of time that it takes to import all of the endpoints
                        into Amazon Pinpoint.
                     </p>
                     
                     <h2 id="tutorials-importing-data-lambda-function-input-split-create">Step 4.1: Create the Function</h2>
                     
                     <p>To create the first Lambda function for this tutorial, you first have to upload the
                        .zip file that you created in <a href=".html#">Step 3</a>. Next, you set up the function
                        itself.
                     </p>
                     
                     <p class="title"><b>To create the Lambda function</b></p>
                     <ol>
                        <li>
                           <p>Open the AWS Lambda console at
                              <a href="https://console.aws.amazon.com/lambda/" target="_blank">https://console.aws.amazon.com/lambda/</a>.
                           </p>
                        </li>
                        <li>
                           
                           <p>Choose <b>Create function</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Author from scratch</b>. Under <b>Basic
                                 information</b>, do the following:
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>For <b>Function name</b>, enter
                                       <b>CustomerImport_ReadIncomingAndSplit</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>For <b>Runtime</b>, choose <b>Python
                                          3.7</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>For <b>Execution role</b>, choose <b>Use an
                                          existing role</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>For <b>Existing role</b>, choose
                                       <b>ImporterS3Role</b>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>Choose <b>Create function</b>. 
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>Under <b>Function code</b>, for <b>Code entry
                                 type</b>, choose <b>Upload a .zip file</b>. Under
                              <b>Function package</b>, choose <b>Upload</b>.
                              Choose the <code>pinpoint-importer.zip</code> file that you created in
                              <a href="tutorials-importing-data-create-python-package.html">Step
                                 3</a>. After you select the file, choose <b>Save</b>. 
                           </p>
                           
                           <div class="aws-note">
                              <p class="aws-note">Note</p>
                              <p>After you choose <b>Save</b>, you receive an error message
                                 stating that Lambda couldn’t open the file
                                 <code>lambda_function.py</code>. Dismiss this error; you create
                                 this file in the next step.
                              </p>
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>In the function editor, on the <b>File</b> menu, choose
                              <b>New File</b>. The editor creates a new file named
                              <code>Untitled1</code>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Paste the following code in the editor:</p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="py ">import os
import boto3
import s3fs
from botocore.exceptions import ClientError

input_archive_folder = "input_archive"
to_process_folder = "to_process"
file_row_limit = 50
file_delimiter = ','

# S3 bucket info
s3 = s3fs.S3FileSystem(anon=False)
    
def lambda_handler(event, context):
    print("Received event: \n" + str(event))
    for record in event['Records']:
        # Assign some variables that make it easier to work with the data in the 
        # event record.
        bucket = record['s3']['bucket']['name']
        key = record['s3']['object']['key']
        input_file = os.path.join(bucket,key)
        archive_path = os.path.join(bucket,input_archive_folder,os.path.basename(key))
        folder =  os.path.split(key)[0]
        s3_url = os.path.join(bucket,folder)
        output_file_template = os.path.splitext(os.path.basename(key))[0] + "__part"
        output_path = os.path.join(bucket,to_process_folder)
        
        # Set a variable that contains the number of files that this Lambda 
        # function creates after it runs.
        num_files = file_count(s3.open(input_file, 'r'), file_delimiter, file_row_limit)
        
        # Split the input file into several files, each with 50 rows.
        split(s3.open(input_file, 'r'), file_delimiter, file_row_limit, output_file_template, output_path, True, num_files)
        
        # Send the unchanged input file to an archive folder.
        archive(input_file,archive_path)
    
# Determine the number of files that this Lambda function will create.
def file_count(file_handler, delimiter, row_limit):
    import csv 
    reader = csv.reader(file_handler, delimiter=delimiter)
    # Figure out the number of files this function will generate.
    row_count = sum(1 for row in reader) - 1
    # If there's a remainder, always round up.
    file_count = int(row_count // row_limit) + (row_count % row_limit &gt; 0)
    return file_count

# Split the input into several smaller files.
def split(filehandler, delimiter, row_limit, output_name_template, output_path, keep_headers, num_files):
    import csv 
    reader = csv.reader(filehandler, delimiter=delimiter)
    
    current_piece = 1
    current_out_path = os.path.join(
         output_path,
         output_name_template + str(current_piece) + "__of" + str(num_files) + ".csv"
    )
    current_out_writer = csv.writer(s3.open(current_out_path, 'w'), delimiter=delimiter)
    current_limit = row_limit
    if keep_headers:
        headers = next(reader)
        current_out_writer.writerow(headers)
    for i, row in enumerate(reader):
        if i + 1 &gt; current_limit:
            current_piece += 1
            current_limit = row_limit * current_piece
            current_out_path = os.path.join(
               output_path,
               output_name_template + str(current_piece) + "__of" + str(num_files) + ".csv"
            )
            current_out_writer = csv.writer(s3.open(current_out_path, 'w'), delimiter=delimiter)
            if keep_headers:
                current_out_writer.writerow(headers)
        current_out_writer.writerow(row)

# Move the original input file into an archive folder.
def archive(input_file, archive_path):
    s3.copy_basic(input_file,archive_path)
    print("Moved " + input_file + " to " + archive_path)
    s3.rm(input_file)</code></pre>
                           </li>
                        <li>
                           
                           <p>In the function editor, on the <b>File</b> menu, choose
                              <b>Save As</b>. Save the file as
                              <code>lambda_function.py</code> in the root directory for the
                              function.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>At the top of the page, choose <b>Save</b>.
                           </p>
                           
                        </li>
                     </ol>
                     
                     
                     <h2 id="tutorials-importing-data-lambda-function-input-split-test">Step 4.2: Test the Function</h2>
                     
                     <p>After you create the function, you should test it to ensure that it's set up
                        correctly.
                     </p>
                     
                     <p class="title"><b>To test the Lambda function</b></p>
                     <ol>
                        <li>
                           
                           <p>In a text editor, create a new file. In the file, paste the following
                              text:
                           </p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="nohighlight">Salutation,First Name,Last Name,Title,Mailing Street,Mailing City,Mailing State/Province,Mailing Zip/Postal Code,Mailing Country,Phone,Email,Contact Record Type,Account Name,Account Owner,Lead Source
Mr.,Alejandro,Rosales,Operations Manager,414 Main Street,Anytown,AL,95762,United States,+18705550156,arosales@example.com,Customer,Example Corp.,Richard Roe,Website
Ms.,Ana Carolina,Silvia,Customer Service Representative,300 First Avenue,Any Town,AK,65141,United States,(727) 555-0128,asilvia@example.com,Qualified Lead,AnyCompany,Jane Doe,Seminar
Mrs.,Juan,Li,Auditor,717 Kings Street,Anytown,AZ,18162,United States,768.555.0122,jli@example.com,Unqualified Lead,Example Corp.,Richard Roe,Phone
Dr.,Arnav,Desai,Senior Analyst,782 Park Court,Anytown,AR,27084,United States,+17685550162,adesai@example.com,Customer,Example Corp.,Richard Roe,Website
Mr.,Mateo,Jackson,Sales Representative,372 Front Street,Any Town,CA,83884,United States,(781) 555-0169,mjackson@example.com,Customer,AnyCompany,Jane Doe,Seminar
Mr.,Nikhil,Jayashankar,Executive Assistant,468 Fifth Avenue,Anytown,CO,75376,United States,384.555.0178,njayashankar@example.com,Qualified Lead,Example Corp.,Jane Doe,Website
Mrs.,Shirley,Rodriguez,Account Manager,287 Park Avenue,Any Town,CT,26715,United States,+12455550188,srodriguez@example.com,Qualified Lead,Example Corp.,Richard Roe,Seminar
Ms.,Xiulan,Wang,Information Architect,107 Queens Place,Anytown,DE,70710,United States,(213) 555-0192,xwang@example.com,Unqualified Lead,Example Corp.,Richard Roe,Phone
Miss,Saanvi,Sarkar,Director of Finance,273 Sample Boulevard,Any Town,FL,85431,United States,237.555.0121,ssarkar@example.com,Customer,AnyCompany,Richard Roe,Referral
Mr.,Wei,Zhang,Legal Counsel,15 Third Avenue,Any Town,GA,82387,United States,+18065550179,wzhang@example.com,Customer,AnyCompany,Jane Doe,Website</code></pre>
                           <p>Save the file as <code>testfile.csv</code>.
                           </p>
                           
                           <div class="aws-note">
                              <p class="aws-note">Note</p>
                              <p>This file contains fictitious contact records. You only use it to test the
                                 Lambda function that you create in this tutorial. Later, you can delete the
                                 segments that contain this fictitious data.
                              </p>
                              <p>For now, don't add or remove any columns to the file. After you implement
                                 the solution that's shown in this tutorial, you can modify it to meet your
                                 needs.
                              </p>
                           </div>
                           
                        </li>
                        <li>
                           <p>Open the Amazon S3 console at
                              <a href="https://console.aws.amazon.com/s3/" target="_blank">https://console.aws.amazon.com/s3/</a>.
                           </p>
                        </li>
                        <li>
                           
                           <p>In the list of buckets, choose the bucket that you created in <a href="tutorials-importing-data-create-s3-bucket.html">Step 1</a>, and then
                              choose the <code>input</code> folder.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Upload</b>. Upload the
                              <code>testfile.csv</code> file that you just created.
                           </p>
                           
                        </li>
                        <li>
                           <p>Open the AWS Lambda console at
                              <a href="https://console.aws.amazon.com/lambda/" target="_blank">https://console.aws.amazon.com/lambda/</a>.
                           </p>
                        </li>
                        <li>
                           
                           <p>In the list of functions, choose the
                              <b>CustomerImport_ReadIncomingAndSplit</b> function that you
                              created earlier.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Test</b>. On the <b>Configure test
                                 event</b> window, for <b>Event name</b>, enter
                              <strong class="userinput"><code>TestEvent</code></strong>. Then, in the editor, paste the following
                              code:
                           </p>
                           <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"></div><div class="btn-dark-theme" title="Dark theme" title-dark="Dark theme" title-light="Light theme"></div></div><code class="json ">{
  "Records": [
    {
      "s3": {
        "bucket": {
          "name": "<em class="replaceable"><code>bucket-name</code></em>",
          "arn": "arn:aws:s3:::<em class="replaceable"><code>bucket-name</code></em>"
        },
        "object": {
          "key": "input/testfile.csv"
        }
      }
    }
  ]
}</code></pre>
                           <p>In the preceding example, replace <em class="replaceable"><code>bucket-name</code></em> with
                              the name of the Amazon S3 bucket that you created in <a href="tutorials-importing-data-create-s3-bucket.html">Step 1</a>. When you
                              finish, choose <b>Create</b>.
                           </p>
                           
                        </li>
                        <li>
                           
                           <p>Choose <b>Test</b> again. The function will execute with the
                              test event that you provided.
                           </p>
                           
                           <p>If the function runs as expected, proceed to the next step.</p>
                           
                           <p>If the function fails to complete, do the following: </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>Make sure that you specified the correct bucket name in the IAM
                                       policy that you created in <a href="tutorials-importing-data-create-iam-roles.html">Step 2: Create IAM
                                          Roles</a>.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>Make sure that the Lambda test event that you created in step 7 of this
                                       section refers to the correct bucket and file name.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>If you named the input file something other than
                                       <code>testfile.csv</code>, make sure that the filename
                                       doesn't contain any spaces.
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                        </li>
                        <li>
                           
                           <p>Return to the <a href="https://console.aws.amazon.com/s3/" target="_blank">Amazon S3 console</a>.
                              Choose the bucket that you created in <a href="tutorials-importing-data-create-s3-bucket.html">Step 1: Create an Amazon S3
                                 Bucket</a>.
                           </p>
                           
                           <p>Open the folders in the bucket and take note of the contents of each one. If
                              all of the following statements are true, then the Lambda function worked as
                              expected:
                           </p>
                           
                           <div class="itemizedlist">
                              
                              
                              
                              
                              <ul class="itemizedlist" type="disc">
                                 <li class="listitem">
                                    
                                    <p>The <code>input</code> folder doesn't contain any
                                       files.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>The <code>input_archive</code> folder contains the file that
                                       you uploaded in step 4 of this section.
                                    </p>
                                    
                                 </li>
                                 <li class="listitem">
                                    
                                    <p>The <code>to_process</code> folder contains a file named
                                       <code>testfile__part1__of1.csv</code>.
                                    </p>
                                    
                                 </li>
                              </ul>
                           </div>
                           
                           <p>Don't delete any of the newly generated files. The Lambda function that you
                              create in the next step uses the files in the <code>to_process</code>
                              folder.
                           </p>
                           
                        </li>
                     </ol>
                     
                     <p><b>Next</b>: <a href="tutorials-importing-data-lambda-function-process-incoming.html">Create a Lambda
                           Function That Processes the Incoming Records</a></p>
                  </div>
                  <noscript>
                     <div>
                        <div>
                           <div>
                              <div id="js_error_message">
                                 <p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p>
                                 <p>To use the AWS Documentation, Javascript must be enabled. Please refer to your browser's
                                    Help pages for instructions.
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                  </noscript>
                  <div id="main-col-footer">
                     <div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div>
                     <div id="next"><a class="awstoc" accesskey="p" href="tutorials-importing-data-create-python-package.html">« Previous </a><a class="awstoc" accesskey="n" href="tutorials-importing-data-lambda-function-process-incoming.html">Next »</a></div>
                     <div id="copyright-main-footer">© 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.</div>
                  </div>
               </div>
            </div>
            <div id="right-expanded">
               <div id="right-content-wrapper">
                  <div id="pagetoc">
                     <p>On this page:</p>
                     <ul class="pagetoc">
                        <li class="pagetoc" name="Step 4.1: Create the Function"><a class="pagetoc" href="#tutorials-importing-data-lambda-function-input-split-create">Step 4.1: Create the Function</a></li>
                        <li class="pagetoc" name="Step 4.2: Test the Function"><a class="pagetoc" href="#tutorials-importing-data-lambda-function-input-split-test">Step 4.2: Test the Function</a></li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
      </div>
      <div id="cookie-notice">
         <div class="cookie-notice-text">We use cookies to provide and improve our services. By using our site, you consent
            to cookies. <a href="http://aws.amazon.com/legal/cookies">Learn more</a></div>
      </div>
      <div id="footer">
         <div id="footer_short_fb" class="hide" title="Feedback"><a target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Pinpoint&amp;topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html&amp;hidden_guide_name=Developer Guide&amp;hidden_api_version=&amp;hidden_file_name=tutorials-importing-data-lambda-function-input-split"><i class="awsdocs-footer-text fa fa-envelope-o"></i></a></div>
         <div id="footer_toggle" class="mediaobject">
            <div id="footer_toggle_img" class="awsdocs-footer-text fa fa-caret-down"></div>
            <div id="footer_toggle_img_collapse" class="hide awsdocs-footer-text fa fa-caret-right"></div>
         </div>
         <div id="footer-left"><a class="awsdocs-footer-text" target="_top" href="http://aws.amazon.com/terms">Terms of Use</a><span class="awsdocs-footer-text"> | </span><a class="awsdocs-footer-text" target="_top" href="http://aws.amazon.com/privacy">Privacy</a><span class="awsdocs-footer-text"> | </span><span class="awsdocs-footer-text">© 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.</span></div>
         <div id="footer-right">
            <div id="feedback">
               <div id="forums"><a id="forum_link" target="_blank" href="http://forums.aws.amazon.com/forum.jspa?forumID=225" class="awsdocs-footer-text">Have a question? Try the Forums.</a></div>
               <div id="feedback-message" class="awsdocs-footer-text">Did this page help you?</div>
               <div id="feedback-yesno-buttons"><a class="awstoc btn btn-default" target="_blank" href="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">Yes</a><a class="awstoc btn btn-default" target="_blank" href="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html">No</a></div>
               <div id="feedback-feedback-button"><a class="awstoc btn btn-default" target="_blank" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Pinpoint&amp;topic_url=http://docs.aws.amazon.com/en_us/pinpoint/latest/developerguide/tutorials-importing-data-lambda-function-input-split.html&amp;hidden_guide_name=Developer Guide&amp;hidden_api_version=&amp;hidden_file_name=tutorials-importing-data-lambda-function-input-split">Feedback</a></div>
            </div>
         </div>
      </div>
      <!-- SiteCatalyst code version: H.25.2.
            Copyright 1996-2012 Adobe, Inc. All Rights Reserved
            More info available at http://www.omniture.com --><script language="JavaScript" type="text/javascript" src="https://a0.awsstatic.com/s_code/js/1.0/awshome_s_code.js"></script><script language="JavaScript" type="text/javascript">
         <!--

            // Documentation Service Name
            s.prop66='Amazon Pinpoint';
            s.eVar66='D=c66';
  
            // Documentation Guide Name                                                                 
            s.prop65='Developer Guide';
            s.eVar65='D=c65';

            var s_code=s.t();if(s_code)document.write(s_code)//--></script><script language="JavaScript" type="text/javascript">
         <!--
                if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
                //--></script><noscript><img src="https://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="" /></noscript>
      <!--/DO NOT REMOVE/-->
      <!-- End SiteCatalyst code version: H.25.2. -->
   </body>
</html>